{{ partial "head" . }}

<body class="home-template"><div class="site-wrapper">

{{ partial "header" . }}

<main id="site-main" class="site-main outer" role="main">
  <div class="inner">
    <div class="post-feed">
      {{ $paginator := .Paginate .Site.RegularPages }}
      {{ range $paginator.Pages }}

      <article class="post-card post"> 
          {{if .Params.image}}
          <a class="post-card-image-link" href="{{ .Permalink }}">
            <div class="post-card-image" style="background-image: url({{.Params.image | absURL}})"></div>
          </a>
          {{else}}
          <a class="post-card-image-link" href="{{ .Permalink }}">
            <div class="post-card-image" style="background-image: url({{$.Site.BaseURL}}defimg/{{ index (seq 7 | shuffle) 0 }}.jpg)"></div>
          </a>    
          {{end}}

          <div class="post-card-content">
            <a class="post-card-content-link" href="{{ .Permalink }}">
                <header class="post-card-header">
                    {{if .Params.tags }}<span class="post-card-tags">{{ range $index, $tag := .Params.tags }}
                    #{{$tag}} {{end}} </span>
                    {{ end }}
                    <h2 class="post-card-title">{{.Title}}</h2>
                </header>
                <section class="post-card-excerpt">
                    {{ if .Description }} 
                      <p>{{ .Description | markdownify }}</p>
                    {{else}}
                      <p>{{ .Summary | plainify | safeHTML }}{{ if .Truncated }} ... {{end}} </p>
                    {{end}}
                </section>
            </a>

            <footer class="post-card-meta">
                <img class="author-profile-image" src="{{ (.Params.authorAvatar | default .Site.Params.authorAvatar) | absURL}}" alt="Author" />
                <span class="post-card-author"><a href="/">{{.Params.author | default .Site.Params.author}}</a></span>
            </footer>
          </div>
      </article>
      {{ end }}
    </div>

    <nav class="pagination" role="navigation">
      {{if .Paginator.HasPrev}}
          <a class="newer-posts" href="{{ .Paginator.Prev.URL }}">&larr; <span class="hide">Next Posts</span></a>
      {{end}}
      <span class="page-number"><span class="hide">Page {{ .Paginator.PageNumber }} of {{.Paginator.TotalPages}}</span>&nbsp;</span>
      {{if .Paginator.HasNext}}
          <a class="older-posts" href="{{ .Paginator.Next.URL }}"><span class="hide">Previous Posts</span> &rarr;</a>
      {{end}}
    </nav>
  </div>
</main>

{{ partial "footer" . }}
</div>{{ partial "js" . }}</body></html>
